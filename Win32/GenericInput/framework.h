#pragma once

#define WIN32_LEAN_AND_MEAN             // Exclude rarely-used stuff from Windows headers
// Windows Header Files
#include <windows.h>
#include <initguid.h>
#include <Usbiodef.h>
#include <ioapiset.h>
#include <hidsdi.h>
#include <Hidclass.h>
#include <dbt.h>
#include <bluetoothapis.h>
#include <Bthdef.h>
#include <setupapi.h>
#include <Cfgmgr32.h>
#include <vector>
#include <string>
#include <algorithm>
#include <unknwn.h>
#define CONTROLLER_BUTTON_A 0x1000
#define CONTROLLER_BUTTON_B 0x2000
#define CONTROLLER_BUTTON_X 0x4000
#define CONTROLLER_BUTTON_Y 0x8000
#define CONTROLLER_BUTTON_BACK 0x0020
#define CONTROLLER_BUTTON_GUIDE 0x00400
#define CONTROLLER_BUTTON_START 0x0010
#define CONTROLLER_BUTTON_LEFTSTICK 0x0040
#define CONTROLLER_BUTTON_RIGHTSTICK 0x0080
#define CONTROLLER_BUTTON_LEFTSHOULDER 0x0100
#define CONTROLLER_BUTTON_RIGHTSHOULDER 0x0200
#define CONTROLLER_BUTTON_DPAD_UP 0x0001
#define CONTROLLER_BUTTON_DPAD_DOWN 0x0002
#define CONTROLLER_BUTTON_DPAD_LEFT 0x0004
#define CONTROLLER_BUTTON_DPAD_RIGHT 0x0008
#define CONTROLLER_GAMEPAD_GUIDE 0x0400

DEFINE_GUID(GUID_DEVCLASS_XINPUT, 0xec87f1e3, 0xc13b, 0x4100, 0xb5, 0xf7, 0x8b, 0x84, 0xd5, 0x42, 0x60, 0xcb);
//{e0cbf06c-cd8b-4647-bb8a-263b43f0f974}
DEFINE_GUID(GUID_DEVCLASS_BLUETOOTH, 0xE0CBF06C, 0xCD8B, 0x4647, 0xBB, 0x8A, 0x26, 0x3B, 0x43, 0xF0, 0xF9, 0x74);
#include "GenericInputController.h"

typedef struct _GAMEPAD_DATA {//DO NOT MODIFY, DOING SO WILL BREAK THE CONTROLLER DATABASE!
	USHORT VID;
	USHORT PID;
	std::wstring Name;
	BYTE  bLeftTrigger;
	BYTE  bRightTrigger;
	std::wstring TriggerType; // a is analog, b is digital
	SHORT sThumbLX;
	SHORT sThumbLY;
	SHORT sThumbRX;
	SHORT sThumbRY;
	BYTE bButtonA;
	BYTE bButtonB;
	BYTE bButtonX;
	BYTE bButtonY;
	BYTE bButtonBack;
	BYTE bButtonGuide;
	BYTE bButtonStart;
	BYTE bButtonLeftStick;
	BYTE bButtonRightStick;
	BYTE bButtonLeftShoulder;
	BYTE bButtonRightShoulder;
	BYTE bButtonDpadUp;
	BYTE bButtonDpadDown;
	BYTE bButtonDpadLeft;
	BYTE bButtonDpadRight;

} GAMEPAD_DATA, * P_GAMEPAD_DATA;
const SHORT XByteToShort[] = {
-32767,

-32130,-31875,-31620,-31365,
-31110,-30855,-30600,-30345,-30090,-29835,
-29580,-29325,-29070,-28815,-28560,-28305,
-28050,-27795,-27540,-27285,-27030,-26775,
-26520,-26265,-26010,-25755,-25500,-25245,
-24990,-24735,-24480,-24225,-23970,-23715,
-23460,-23205,-22950,-22695,-22440,-22185,
-21930,-21675,-21420,-21165,-20910,-20655,
-20400,-20145,-19890,-19635,-19380,-19125,
-18870,-18615,-18360,-18105,-17850,-17595,
-17340,-17085,-16830,-16575,-16320,-16065,
-15810,-15555,-15300,-15045,-14790,-14535,
-14280,-14025,-13770,-13515,-13260,-13005,
-12750,-12495,-12240,-11985,-11730,-11475,
-11220,-10965,-10710,-10455,-10200,-9945,
-9690,-9435,-9180,-8925,-8670,-8415,
-8160,-7905,-7650,-7395,-7140,-6885,
-6630,-6375,-6120,-5865,-5610,-5355,
-5100,-4845,-4590,-4335,-4080,-3825,
-3570,-3315,-3060,-2805,-2550,-2295,
-2040,-1785,-1530,-1275,-1020,-765,
-510,-255, 0,255,510,765,1020,1275,1530,
1785,2040,2295,2550,2805,3060,
3315,3570,3825,4080,4335,4590,
4845,5100,5355,5610,5865,6120,
6375,6630,6885,7140,7395,7650,
7905,8160,8415,8670,8925,9180,
9435,9690,9945,10200,10455,10710,
10965,11220,11475,11730,11985,12240,
12495,12750,13005,13260,13515,13770,
14025,14280,14535,14790,15045,15300,
15555,15810,16065,16320,16575,16830,
17085,17340,17595,17850,18105,18360,
18615,18870,19125,19380,19635,19890,
20145,20400,20655,20910,21165,21420,
21675,21930,22185,22440,22695,22950,
23205,23460,23715,23970,24225,24480,
24735,24990,25245,25500,25755,26010,
26265,26520,26775,27030,27285,27540,
27795,28050,28305,28560,28815,29070,
29325,29580,29835,30090,30345,30600,
30855,31110,31365,31620,31875,32130,
32386,

32767
};
const SHORT YByteToShort[] = {
32767,

32130,31875,31620,31365,
31110,30855,30600,30345,30090,29835,
29580,29325,29070,28815,28560,28305,
28050,27795,27540,27285,27030,26775,
26520,26265,26010,25755,25500,25245,
24990,24735,24480,24225,23970,23715,
23460,23205,22950,22695,22440,22185,
21930,21675,21420,21165,20910,20655,
20400,20145,19890,19635,19380,19125,
18870,18615,18360,18105,17850,17595,
17340,17085,16830,16575,16320,16065,
15810,15555,15300,15045,14790,14535,
14280,14025,13770,13515,13260,13005,
12750,12495,12240,11985,11730,11475,
11220,10965,10710,10455,10200,9945,
9690,9435,9180,8925,8670,8415,
8160,7905,7650,7395,7140,6885,
6630,6375,6120,5865,5610,5355,
5100,4845,4590,4335,4080,3825,
3570,3315,3060,2805,2550,2295,
2040,1785,1530,1275,1020,765,
510,255, 0,-255,-510,-765,-1020,-1275,-1530,
-1785,-2040,-2295,-2550,-2805,-3060,
-3315,-3570,-3825,-4080,-4335,-4590,
-4845,-5100,-5355,-5610,-5865,-6120,
-6375,-6630,-6885,-7140,-7395,-7650,
-7905,-8160,-8415,-8670,-8925,-9180,
-9435,-9690,-9945,-10200,-10455,-10710,
-10965,-11220,-11475,-11730,-11985,-12240,
-12495,-12750,-13005,-13260,-13515,-13770,
-14025,-14280,-14535,-14790,-15045,-15300,
-15555,-15810,-16065,-16320,-16575,-16830,
-17085,-17340,-17595,-17850,-18105,-18360,
-18615,-18870,-19125,-19380,-19635,-19890,
-20145,-20400,-20655,-20910,-21165,-21420,
-21675,-21930,-22185,-22440,-22695,-22950,
-23205,-23460,-23715,-23970,-24225,-24480,
-24735,-24990,-25245,-25500,-25755,-26010,
-26265,-26520,-26775,-27030,-27285,-27540,
-27795,-28050,-28305,-28560,-28815,-29070,
-29325,-29580,-29835,-30090,-30345,-30600,
-30855,-31110,-31365,-31620,-31875,-32130,
-32386,
-32767
};
const SHORT XByteToShortAlt[] = {
-32767,-32767,-32767,-32767,-32767,-32767,-32767,-32767,-32767,-32767,-32767,-32767,-32767,-32767,-32767,-32767,-32767,-32767,-32767,-32767,-32767,-32767,-32767,-32767,-32767,-32767,-32767,-32767,-32767,
-32130, -31842, -31554, -31266, -30978, -30690, -30402, -30114, -29826, -29538, -29250, -28962, -28674, -28386, -28098, -27810, -27522, -27234, -26946, -26658, -26370, -26082, -25794, -25506, -25218, -24930, -24642, -24354, -24066, -23778, -23490, -23202, -22914, -22626, -22338, -22050, -21762, -21474, -21186, -20898, -20610, -20322, -20034, -19746, -19458, -19170, -18882, -18594, -18306, -18018, -17730, -17442, -17154, -16866, -16578, -16290, -16002, -15714, -15426, -15138, -14850, -14562, -14274, -13986, -13698, -13410, -13122, -12834, -12546, -12258, -11970, -11682, -11394, -11106, -10818, -10530, -10242, -9954, -9666, -9378, -9090, -8802, -8514, -8226, -7938, -7650, -7362, -7074, -6786, -6498, -6210, -5922, -5634, -5346, -5058, -4770, -4482, -4194, -3906, -3618, -3330, -3042, -2754, -2466, -2178, -1890, -1602, -1314, -1026, -738, -450, -162, 126, 414, 702, 990, 1278, 1566, 1854, 2142, 2430, 2718, 3006, 3294, 3582, 3870, 4158, 4446, 4734, 5022, 5310, 5598, 5886, 6174, 6462, 6750, 7038, 7326, 7614, 7902, 8190, 8478, 8766, 9054, 9342, 9630, 9918, 10206, 10494, 10782, 11070, 11358, 11646, 11934, 12222, 12510, 12798, 13086, 13374, 13662, 13950, 14238, 14526, 14814, 15102, 15390, 15678, 15966, 16254, 16542, 16830, 17118, 17406, 17694, 17982, 18270, 18558, 18846, 19134, 19422, 19710, 19998, 20286, 20574, 20862, 21150, 21438, 21726, 22014, 22302, 22590, 22878, 23166, 23454, 23742, 24030, 24318, 24606, 24894, 25182, 25470, 25758, 26046, 26334, 26622, 26910, 27198, 27486, 27774, 28062, 28350, 28638, 28926, 29214, 29502, 29790, 30078, 30366, 30654, 30942, 31230, 31518, 31806, 32094, 32382, 32670,
32767,
};
const SHORT YByteToShortAlt[] = {
32767,32767,32767,32767,32767,32767,32767,32767,32767,32767,32767,32767,32767,32767,32767,32767,32767,32767,32767,32767,32767,32767,32767,32767,32767,32767,32767,32767,32767,
32475, 32186, 31897, 31608, 31319, 31030, 30741, 30452, 30163, 29874, 29585, 29296, 29007, 28718, 28429, 28140, 27851, 27562, 27273, 26984, 26695, 26406, 26117, 25828, 25539, 25250, 24961, 24672, 24383, 24094, 23805, 23516, 23227, 22938, 22649, 22360, 22071, 21782, 21493, 21204, 20915, 20626, 20337, 20048, 19759, 19470, 19181, 18892, 18603, 18314, 18025, 17736, 17447, 17158, 16869, 16580, 16291, 16002, 15713, 15424, 15135, 14846, 14557, 14268, 13979, 13690, 13401, 13112, 12823, 12534, 12245, 11956, 11667, 11378, 11089, 10800, 10511, 10222, 9933, 9644, 9355, 9066, 8777, 8488, 8199, 7910, 7621, 7332, 7043, 6754, 6465, 6176, 5887, 5598, 5309, 5020, 4731, 4442, 4153, 3864, 3575, 3286, 2997, 2708, 2419, 2130, 1841, 1552, 1263, 974, 685, 396, 107, -182, -471, -760, -1049, -1338, -1627, -1916, -2205, -2494, -2783, -3072, -3361, -3650, -3939, -4228, -4517, -4806, -5095, -5384, -5673, -5962, -6251, -6540, -6829, -7118, -7407, -7696, -7985, -8274, -8563, -8852, -9141, -9430, -9719, -10008, -10297, -10586, -10875, -11164, -11453, -11742, -12031, -12320, -12609, -12898, -13187, -13476, -13765, -14054, -14343, -14632, -14921, -15210, -15499, -15788, -16077, -16366, -16655, -16944, -17233, -17522, -17811, -18100, -18389, -18678, -18967, -19256, -19545, -19834, -20123, -20412, -20701, -20990, -21279, -21568, -21857, -22146, -22435, -22724, -23013, -23302, -23591, -23880, -24169, -24458, -24747, -25036, -25325, -25614, -25903, -26192, -26481, -26770, -27059, -27348, -27637, -27926, -28215, -28504, -28793, -29082, -29371, -29660, -29949, -30238, -30527, -30816, -31105, -31394, -31683, -31972, -32261, -32550,
	-32767
};